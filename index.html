<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Vision Trainer Ultimate</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="startScreen" class="view active">
        <div class="menu-box">
            <h1>Chess Vision Trainer</h1>
            <p>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Ç–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑—Ä–µ–Ω–∏—è</p>
            
            <div class="form-group" style="background: #fff3cd; padding: 10px; border-radius: 8px; margin: 15px 0;">
                <label>üéØ –°–ª–æ–∂–Ω–æ—Å—Ç—å:</label>
                <select id="difficultySelect" style="padding: 8px; font-size: 1rem; width: 100%; border-radius: 4px; border: 1px solid #ccc; margin-top: 5px;">
                    <option value="all">üé≤ –°–ª—É—á–∞–π–Ω–∞—è (–í—Å–µ)</option>
                    <option value="easy">üü¢ –õ–µ–≥–∫–∞—è (–º–∞–ª–æ —Ñ–∏–≥—É—Ä)</option>
                    <option value="medium">üü° –°—Ä–µ–¥–Ω—è—è</option>
                    <option value="hard">üî¥ –°–ª–æ–∂–Ω–∞—è (—Ö–∞–æ—Å)</option>
                </select>
            </div>

            <div class="form-group">
                <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á (–¥–æ—Å—Ç—É–ø–Ω–æ: <span id="maxPuzzlesCount">...</span>):</label>
                <input type="number" id="taskCountInput" min="1" value="5" class="number-input">
            </div>

            <div class="form-group" style="background: #eef; padding: 10px; border-radius: 8px; margin: 15px 0;">
                <label>‚è≥ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (—Å–µ–∫):</label>
                <input type="number" id="timeLimitInput" min="0" value="0" class="number-input" style="width: 100px;">
                <div style="font-size: 0.8rem; color: #555; margin-top: 5px;">0 = –±–µ–∑–ª–∏–º–∏—Ç (–ø—Ä–æ—Å—Ç–æ —Ç–∞–π–º–µ—Ä)</div>
                
                <div style="margin-top: 10px; text-align: left;">
                    <label style="font-weight: normal;">
                        <input type="radio" name="timeMode" value="per_puzzle" checked> –ù–∞ –æ–¥–Ω—É –∑–∞–¥–∞—á—É
                    </label>
                    <br>
                    <label style="font-weight: normal;">
                        <input type="radio" name="timeMode" value="total"> –ù–∞ –≤—Å—é —Å–µ—Å—Å–∏—é
                    </label>
                </div>
            </div>

            <div class="settings-list">
                <h3>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <label><input type="checkbox" id="setSequential"> üîÑ –ü–æ–æ—á–µ—Ä–µ–¥–Ω—ã–π —Ä–µ–∂–∏–º (W->B)</label>
                <label><input type="checkbox" id="setAutoFlip" checked> üîÅ –ê–≤—Ç–æ-–ø–æ–≤–æ—Ä–æ—Ç –¥–æ—Å–∫–∏</label>
                <label><input type="checkbox" id="setHighlights" checked> üü© –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ</label>
                <label><input type="checkbox" id="setHints" checked> üî¢ –°—á–µ—Ç—á–∏–∫–∏ (Hints)</label>
                <label><input type="checkbox" id="setStatusText" checked> üí¨ –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã</label>
                <label><input type="checkbox" id="setShowLog" checked> üìú –ò—Å—Ç–æ—Ä–∏—è —Ö–æ–¥–æ–≤</label> <label><input type="checkbox" id="setCoords" checked> üî† –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (a-h, 1-8)</label>
            </div>

            <button id="startSessionBtn" class="big-btn">–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
        </div>
    </div>

    <div id="gameScreen" class="view hidden">
        <div class="header">
            <div class="progress-info">
                <span style="color:#777; font-size: 0.9rem;">–ó–∞–¥–∞—á–∞:</span> 
                <span id="progressDisplay" style="color: #333; margin-left: 5px;">1 / 5</span>
            </div>
            
            <div id="taskIndicator" class="task-indicator hidden">–¶–µ–ª—å: <span id="currentTaskName">–ë–µ–ª—ã–µ</span></div>
            
            <div class="timer-box">‚è± <span id="gameTimer">00:00</span></div>
            
            <div class="header-buttons">
                <button id="flipBoardBtn" class="icon-btn" title="–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å –¥–æ—Å–∫—É">üîÑ</button>
                <button id="giveUpBtn" class="icon-btn skip-btn" title="–°–¥–∞—Ç—å—Å—è (–ü—Ä–æ–ø—É—Å–∫)">‚è≠Ô∏è</button>
            </div>
        </div>

        <div class="main-container">
            <div class="board-wrapper">
                <div id="board"></div>
            </div>

            <div class="panel">
                <div id="statusMessage">–•–æ–¥ –±–µ–ª—ã—Ö</div>

                <div class="stats-grid">
                    <div class="stat-card white-card">
                        <div class="card-header">üè≥Ô∏è –ë–µ–ª—ã–µ</div>
                        <div class="stat-row" id="row-w-checks"><span>–®–∞—Ö–∏:</span> <span id="w-checks"
                                class="counter">-</span></div>
                        <div class="stat-row" id="row-w-captures"><span>–í–∑—è—Ç–∏—è:</span> <span id="w-captures"
                                class="counter">-</span></div>
                    </div>
                    <div class="stat-card black-card">
                        <div class="card-header">üè¥ –ß–µ—Ä–Ω—ã–µ</div>
                        <div class="stat-row" id="row-b-checks"><span>–®–∞—Ö–∏:</span> <span id="b-checks"
                                class="counter">-</span></div>
                        <div class="stat-row" id="row-b-captures"><span>–í–∑—è—Ç–∏—è:</span> <span id="b-captures"
                                class="counter">-</span></div>
                    </div>
                </div>

                <div class="log-container">
                    <div class="log-col">
                        <div class="log-header">üè≥Ô∏è –ë–µ–ª—ã–µ</div>
                        <div id="log-white" class="log-list"></div>
                    </div>
                    <div class="log-separator"></div>
                    <div class="log-col">
                        <div class="log-header">üè¥ –ß–µ—Ä–Ω—ã–µ</div>
                        <div id="log-black" class="log-list"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="resultScreen" class="view hidden">
        <div class="result-box">
            <h2>üéâ –°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>

            <div class="summary-grid">
                <div class="sum-item">
                    <span class="sum-label">–†–µ—à–µ–Ω–æ –∑–∞–¥–∞—á</span>
                    <span class="sum-val" id="resTotalSolved">0</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–¢–æ—á–Ω–æ—Å—Ç—å</span>
                    <span class="sum-val" id="resAccuracy">0%</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–û–±—â–µ–µ –≤—Ä–µ–º—è</span>
                    <span class="sum-val" id="resTotalTime">00:00</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–°—Ä–µ–¥–Ω–µ–µ –Ω–∞ –∑–∞–¥–∞—á—É</span>
                    <span class="sum-val" id="resAvgTime">00:00</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–í—Å–µ–≥–æ –∫–ª–∏–∫–æ–≤</span>
                    <span class="sum-val" id="resTotalClicks">0</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–û—à–∏–±–æ–∫</span>
                    <span class="sum-val error-text" id="resTotalErrors">0</span>
                </div>
            </div>

            <h3>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ö–æ–¥–æ–≤</h3>
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                        <th>–ù–∞–π–¥–µ–Ω–æ</th>
                        <th>–í—Å–µ–≥–æ –±—ã–ª–æ</th>
                        <th>%</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>üè≥Ô∏è –®–∞—Ö–∏ –±–µ–ª—ã—Ö</td>
                        <td id="resWCheckFound">0</td>
                        <td id="resWCheckTotal">0</td>
                        <td id="resWCheckPct">0%</td>
                    </tr>
                    <tr>
                        <td>üè≥Ô∏è –í–∑—è—Ç–∏—è –±–µ–ª—ã—Ö</td>
                        <td id="resWCapFound">0</td>
                        <td id="resWCapTotal">0</td>
                        <td id="resWCapPct">0%</td>
                    </tr>
                    <tr>
                        <td>üè¥ –®–∞—Ö–∏ —á–µ—Ä–Ω—ã—Ö</td>
                        <td id="resBCheckFound">0</td>
                        <td id="resBCheckTotal">0</td>
                        <td id="resBCheckPct">0%</td>
                    </tr>
                    <tr>
                        <td>üè¥ –í–∑—è—Ç–∏—è —á–µ—Ä–Ω—ã—Ö</td>
                        <td id="resBCapFound">0</td>
                        <td id="resBCapTotal">0</td>
                        <td id="resBCapPct">0%</td>
                    </tr>
                </tbody>
            </table>

            <div class="result-actions">
                <button id="shareBtn" class="share-btn">üì∏ –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
                <button onclick="location.reload()" class="big-btn">–í –ì–ª–∞–≤–Ω–æ–µ –ú–µ–Ω—é</button>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script src="script.js"></script>
</body>
</html>