<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chess Vision Trainer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css">
    <link rel="stylesheet" href="style.css">
</head>

<body>

    <div id="startScreen" class="view active">
        <div class="menu-box">
            <h1>Chess Vision Trainer</h1>

            <div class="form-group">
                <label class="section-label">üéØ –°–ª–æ–∂–Ω–æ—Å—Ç—å</label>
                <div class="tile-selector">
                    <label class="tile-option">
                        <input type="radio" name="difficulty" value="all">
                        <span class="tile-card">üé≤ –í—Å–µ</span>
                    </label>
                    <label class="tile-option">
                        <input type="radio" name="difficulty" value="easy">
                        <span class="tile-card easy">üü¢ –õ–µ–≥–∫–æ</span>
                    </label>
                    <label class="tile-option">
                        <input type="radio" name="difficulty" value="medium" checked>
                        <span class="tile-card medium">üü° –°—Ä–µ–¥–Ω–µ</span>
                    </label>
                    <label class="tile-option">
                        <input type="radio" name="difficulty" value="hard">
                        <span class="tile-card hard">üî¥ –°–ª–æ–∂–Ω–æ</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label class="section-label">‚è± –†–µ–∂–∏–º –≤—Ä–µ–º–µ–Ω–∏</label>
                <div class="tile-selector two-cols">
                    <label class="tile-option">
                        <input type="radio" name="timeMode" value="per_puzzle" checked>
                        <span class="tile-card">‚è≥ –ù–∞ –∑–∞–¥–∞—á—É</span>
                    </label>
                    <label class="tile-option">
                        <input type="radio" name="timeMode" value="total">
                        <span class="tile-card">‚ö° –ù–∞ —Å–µ—Å—Å–∏—é</span>
                    </label>
                </div>
            </div>

            <div class="form-row">
                <div class="form-group small-group">
                    <label class="input-label">üß© –ö–æ–ª-–≤–æ –∑–∞–¥–∞—á</label>
                    <input type="number" id="taskCountInput" min="1" value="5" class="number-input">
                    <div class="input-hint">–î–æ—Å—Ç—É–ø–Ω–æ: <span id="maxPuzzlesCount">...</span></div>
                </div>

                <div class="form-group small-group">
                    <label class="input-label">‚è± –õ–∏–º–∏—Ç (—Å–µ–∫)</label>
                    <input type="number" id="timeLimitInput" min="0" value="0" class="number-input" placeholder="‚àû">
                    <div class="input-hint">0 = –±–µ–∑–ª–∏–º–∏—Ç</div>
                </div>
            </div>

            <div class="settings-box">
                <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h3>
                <div class="settings-list">
                    <label class="setting-item">
                        <input type="checkbox" id="setSequential">
                        <span>üîÑ –ü–æ–æ—á–µ—Ä–µ–¥–Ω—ã–π —Ä–µ–∂–∏–º</span>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="setAutoFlip" checked>
                        <span>üîÅ –ê–≤—Ç–æ-–ø–æ–≤–æ—Ä–æ—Ç –¥–æ—Å–∫–∏</span>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="setHighlights" checked>
                        <span>üü© –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ö–æ–¥–æ–≤</span>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="setHints" checked>
                        <span>üî¢ –°—á–µ—Ç—á–∏–∫–∏ —Ü–µ–ª–µ–π</span>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="setStatusText" checked>
                        <span>üí¨ –¢–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã</span>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="setShowLog" checked>
                        <span>üìú –ò—Å—Ç–æ—Ä–∏—è —Ö–æ–¥–æ–≤</span>
                    </label>
                    <label class="setting-item">
                        <input type="checkbox" id="setCoords" checked>
                        <span>üî† –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã</span>
                    </label>
                </div>
            </div>

            <button id="startSessionBtn" class="big-btn">–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É</button>
        </div>
    </div>

    <div id="gameScreen" class="view hidden">
        <div class="main-container">
            
            <div class="board-card">
                <div class="board-wrapper">
                    <div id="board"></div>
                </div>
            </div>

            <div class="sidebar-card">
                
                <h2 class="sidebar-title">–ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —à–∞—Ö–∏ –∏ –≤–∑—è—Ç–∏—è!</h2>

                <div class="game-dashboard">
                    
                    <div class="info-pill timer-pill">
                        <span class="icon-spacer">‚è±</span> <span id="gameTimer">00:00</span>
                    </div>

                    <div class="info-pill progress-pill">
                        <span id="progressDisplay">1 / 5</span>
                    </div>

                    <div id="statusMessage" class="status-pill">
                        –£–¥–∞—á–∏!
                    </div>

                    <div class="dashboard-actions">
                        <button id="flipBoardBtn" class="icon-only-btn btn-flip" title="–ü–µ—Ä–µ–≤–µ—Ä–Ω—É—Ç—å">
                            üîÑ
                        </button>
                        <button id="giveUpBtn" class="icon-only-btn btn-skip" title="–°–¥–∞—Ç—å—Å—è / –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å">
                            ‚è≠Ô∏è
                        </button>
                    </div>
                </div>

                <div id="taskIndicator" class="task-indicator hidden">
                    –¶–µ–ª—å: <span id="currentTaskName">...</span>
                </div>

                <table class="game-stats-table">
                    <tbody>
                        <tr>
                            <td>üè≥Ô∏è –®–∞—Ö–∏</td>
                            <td id="w-checks">-</td>
                        </tr>
                        <tr>
                            <td>üè≥Ô∏è –í–∑—è—Ç–∏—è</td>
                            <td id="w-captures">-</td>
                        </tr>
                        <tr>
                            <td>üè¥ –®–∞—Ö–∏</td>
                            <td id="b-checks">-</td>
                        </tr>
                        <tr>
                            <td>üè¥ –í–∑—è—Ç–∏—è</td>
                            <td id="b-captures">-</td>
                        </tr>
                    </tbody>
                </table>

                <div class="log-container">
                    <div class="log-col">
                        <div class="log-header">üè≥Ô∏è –ë–µ–ª—ã–µ</div>
                        <div id="log-white" class="log-list"></div>
                    </div>
                    <div class="log-separator"></div>
                    <div class="log-col">
                        <div class="log-header">üè¥ –ß–µ—Ä–Ω—ã–µ</div>
                        <div id="log-black" class="log-list"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <div id="resultScreen" class="view hidden">
        <div class="result-box">
            <h2 style="margin-bottom: 25px;">üéâ –°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</h2>

            <div class="summary-grid">
                <div class="sum-item">
                    <span class="sum-label">–†–µ—à–µ–Ω–æ</span>
                    <span class="sum-val" id="resTotalSolved">0</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–¢–æ—á–Ω–æ—Å—Ç—å</span>
                    <span class="sum-val" id="resAccuracy">0%</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–í—Ä–µ–º—è</span>
                    <span class="sum-val" id="resTotalTime">00:00</span>
                </div>
                <div class="sum-item">
                    <span class="sum-label">–°—Ä. –≤—Ä–µ–º—è</span>
                    <span class="sum-val" id="resAvgTime">00:00</span>
                </div>
            </div>

            <h3 style="font-size: 1rem; color: #555; margin-bottom: 10px;">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è —Ö–æ–¥–æ–≤</h3>
            <table class="stats-table">
                <thead>
                    <tr>
                        <th>–ö–∞—Ç–µ–≥–æ—Ä–∏—è</th>
                        <th>–ù–∞–π–¥–µ–Ω–æ</th>
                        <th>–í—Å–µ–≥–æ</th>
                        <th>%</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>üè≥Ô∏è –®–∞—Ö–∏ –±–µ–ª—ã—Ö</td>
                        <td id="resWCheckFound">0</td>
                        <td id="resWCheckTotal">0</td>
                        <td id="resWCheckPct">0%</td>
                    </tr>
                    <tr>
                        <td>üè≥Ô∏è –í–∑—è—Ç–∏—è –±–µ–ª—ã—Ö</td>
                        <td id="resWCapFound">0</td>
                        <td id="resWCapTotal">0</td>
                        <td id="resWCapPct">0%</td>
                    </tr>
                    <tr>
                        <td>üè¥ –®–∞—Ö–∏ —á–µ—Ä–Ω—ã—Ö</td>
                        <td id="resBCheckFound">0</td>
                        <td id="resBCheckTotal">0</td>
                        <td id="resBCheckPct">0%</td>
                    </tr>
                    <tr>
                        <td>üè¥ –í–∑—è—Ç–∏—è —á–µ—Ä–Ω—ã—Ö</td>
                        <td id="resBCapFound">0</td>
                        <td id="resBCapTotal">0</td>
                        <td id="resBCapPct">0%</td>
                    </tr>
                </tbody>
            </table>

            <div class="result-actions">
                <button id="shareBtn" class="action-btn btn-success">
                    <span class="btn-icon">üì∏</span> <span class="btn-text">–°–∫—Ä–∏–Ω—à–æ—Ç</span>
                </button>
                <button onclick="location.reload()" class="action-btn btn-primary">
                    <span class="btn-icon">üîÑ</span> <span class="btn-text">–ó–∞–Ω–æ–≤–æ</span>
                </button>
            </div>
        </div>
    </div>

    <div id="timeoutModal" class="modal-overlay hidden">
        <div class="modal-box">
            <div style="font-size: 3rem; margin-bottom: 10px;">‚åõ</div>
            <h2>–í—Ä–µ–º—è –≤—ã—à–ª–æ!</h2>
            <p>–õ–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Å–µ—Å—Å–∏—é –∏—Å—á–µ—Ä–ø–∞–Ω.</p>
            <button id="closeModalBtn" class="big-btn" style="margin-top: 20px;">–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</button>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chess.js/0.10.3/chess.min.js"></script>
    <script src="script.js"></script>
</body>

</html>